<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Adrenal Mass Flowchart</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.5;
            background-color: #f9f9f9;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        /* Interactive Flowchart Container */
        .flowchart-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        /* Step Container */
        .step {
            padding: 40px;
            min-height: 200px;
            display: none;
            border-bottom: 2px solid #eee;
            scroll-margin-top: 20px;
        }
        
        .step.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Node Styles */
        .node {
            margin: 20px 0;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            font-size: 16px;
            line-height: 1.4;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .node:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        
        .start-node {
            background: #cce5ff;
            border-color: #5b9bd5;
            font-weight: 600;
            font-size: 18px;
        }
        
        .decision-node {
            background: #fff2cc;
            border-color: #ffc000;
            font-weight: 500;
        }
        
        .outcome-node {
            background: #e5ccff;
            border-color: #a066d3;
            font-weight: 500;
        }
        
        .action-node {
            background: #d9ead3;
            border-color: #8fbc8f;
            font-weight: 500;
        }
        
        /* Progress indicator */
        .progress {
            background: #2aa198;
            height: 4px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        /* Navigation */
        .nav-buttons {
            padding: 20px;
            text-align: center;
            background: #f8f9fa;
        }
        
        .btn {
            background: #2aa198;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 14px;
            transition: background 0.3s ease;
        }
        
        .btn:hover {
            background: #238e85;
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        /* Back button */
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #2aa198;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            z-index: 1000;
        }
        
        .instruction {
            text-align: center;
            color: #666;
            font-style: italic;
            margin-bottom: 20px;
        }
        
        .step-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
</head>
<body>

    <a href="index.html" class="back-btn">← Back</a>
    
    <h1>Interactive Adrenal Mass Algorithm</h1>

    <div class="flowchart-container">
        <div class="progress" id="progress"></div>
        
        <!-- Step 1: Initial Assessment -->
        <div class="step active" id="step-1">
            <div class="step-title">Initial Assessment</div>
            <div class="instruction">Click on the appropriate path based on imaging findings</div>
            
            <div class="node start-node">
                Incidental, Asymptomatic Adrenal Mass (≥1 cm)<br>
                Detected on any CT or MR exam
            </div>
            
            <div class="node decision-node" onclick="goToStep(2, 'benign')">
                Diagnostic Benign Imaging Features<br>
                (Myelolipoma, No enhancement, Ca++, ≤10 HU, ↓ signal on CS-MR)
            </div>
            
            <div class="node decision-node" onclick="goToStep(2, 'indeterminate')">
                Indeterminate Imaging Features
            </div>
        </div>

        <!-- Step 2A: Benign Features Result -->
        <div class="step" id="step-2a">
            <div class="step-title">Benign Features - Final Result</div>
            
            <div class="node outcome-node">
                Myelolipoma, No enhancement, Ca++ = Benign, no F/U.<br>
                ≤10 HU or ↓ signal on CS-MR = Benign adenoma, no F/U
            </div>
        </div>

        <!-- Step 2B: Size Assessment -->
        <div class="step" id="step-2b">
            <div class="step-title">Size Assessment</div>
            <div class="instruction">Select the appropriate size category</div>
            
            <div class="node decision-node" onclick="goToStep(3, 'small')">
                ≥1-<4 cm
            </div>
            
            <div class="node decision-node" onclick="goToStep(3, 'large')">
                ≥4 cm
            </div>
        </div>

        <!-- Step 3A: Large Mass Management -->
        <div class="step" id="step-3a">
            <div class="step-title">Large Mass (≥4 cm) - Management</div>
            <div class="instruction">Choose based on cancer history</div>
            
            <div class="node action-node" onclick="goToStep(9, 'final')">
                No Cancer History:<br>Consider resection
            </div>
            
            <div class="node action-node" onclick="goToStep(9, 'final')">
                + Cancer History:<br>Consider Bx or PET-CT
            </div>
        </div>

        <!-- Step 3B: Prior Imaging Assessment -->
        <div class="step" id="step-3b">
            <div class="step-title">Prior Imaging & Cancer History Assessment</div>
            <div class="instruction">Select the appropriate clinical scenario</div>
            
            <div class="node decision-node" onclick="goToStep(4, 'prior')">
                Prior Imaging Available
            </div>
            
            <div class="node decision-node" onclick="goToStep(5, 'noPrior')">
                No Prior Imaging<br>No Cancer History
            </div>
            
            <div class="node decision-node" onclick="goToStep(6, 'cancer')">
                No Prior Imaging<br>+ Cancer History & Isolated Adrenal Mass
            </div>
        </div>

        <!-- Step 4: Stability Assessment -->
        <div class="step" id="step-4">
            <div class="step-title">Stability Assessment</div>
            <div class="instruction">Based on comparison with prior imaging</div>
            
            <div class="node outcome-node" onclick="goToStep(9, 'final')">
                Stable ≥1 year<br>→ Benign, no F/U
            </div>
            
            <div class="node decision-node" onclick="goToStep(7, 'enlarging')">
                New or Enlarging
            </div>
        </div>

        <!-- Step 5: No Prior Imaging Path -->
        <div class="step" id="step-5">
            <div class="step-title">Further Evaluation (No Prior, No Cancer History)</div>
            <div class="instruction">Choose appropriate evaluation path</div>
            
            <div class="node action-node" onclick="goToStep(9, 'final')">
                1-2 cm: Probably benign<br>Consider 12 month F/U adrenal CT
            </div>
            
            <div class="node decision-node" onclick="goToStep(6, 'imaging')">
                >2cm, <4cm<br>→ Proceed to adrenal CT
            </div>
            
            <div class="node outcome-node" onclick="goToStep(9, 'final')">
                No enhancement (<10 HU)<br>→ Cyst or hemorrhage, Benign, no F/U
            </div>
        </div>

        <!-- Step 6: Adrenal CT Assessment -->
        <div class="step" id="step-6">
            <div class="step-title">Adrenal CT Assessment</div>
            <div class="instruction">Based on NCCT findings</div>
            
            <div class="node outcome-node" onclick="goToStep(9, 'final')">
                ≤10 HU<br>→ Benign adenoma, no F/U
            </div>
            
            <div class="node decision-node" onclick="goToStep(8, 'washout')">
                >10 HU<br>→ Proceed to washout study
            </div>
        </div>

        <!-- Step 7: Enlarging Mass Assessment -->
        <div class="step" id="step-7">
            <div class="step-title">Enlarging Mass Management</div>
            <div class="instruction">Based on cancer history</div>
            
            <div class="node action-node" onclick="goToStep(9, 'final')">
                No Cancer History:<br>Consider F/U adrenal CT or resection
            </div>
            
            <div class="node action-node" onclick="goToStep(9, 'final')">
                + Cancer History:<br>Consider Bx or PET-CT
            </div>
        </div>

        <!-- Step 8: Washout Study -->
        <div class="step" id="step-8">
            <div class="step-title">Adrenal CT Washout</div>
            <div class="instruction">Based on APW/RPW percentages</div>
            
            <div class="node outcome-node" onclick="goToStep(9, 'final')">
                APW/RPW ≥60/40%<br>→ Benign adenoma, no F/U
            </div>
            
            <div class="node action-node" onclick="goToStep(9, 'final')">
                APW/RPW <60/40%<br>→ Imaging F/U, Bx, PET-CT, or resection<br>depending on clinical scenario
            </div>
        </div>

        <!-- Step 9: Final Summary -->
        <div class="step" id="step-9">
            <div class="step-title">Assessment Complete</div>
            
            <div class="node start-node">
                Algorithm Complete<br>
                Follow the recommended management path
            </div>
            
            <div class="instruction">
                <strong>Key Points:</strong><br>
                • Consider biochemical assays before biopsy/resection<br>
                • "No enhancement" requires contrast comparison<br>
                • "Isolated" = no other metastatic disease<br>
                • Consider chemical-shift MRI when appropriate
            </div>
        </div>

        <div class="nav-buttons">
            <button class="btn" onclick="previousStep()" id="prevBtn" disabled>Previous</button>
            <button class="btn" onclick="resetFlow()">Start Over</button>
            <span id="stepIndicator">Step 1 of 9</span>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 9;
        let stepHistory = [1];

        function goToStep(stepNum, path) {
            // Hide current step
            document.querySelector('.step.active').classList.remove('active');
            
            // Determine which step to show based on path
            let targetStep;
            switch(stepNum) {
                case 2:
                    targetStep = path === 'benign' ? '2a' : '2b';
                    break;
                case 3:
                    targetStep = path === 'large' ? '3a' : '3b';
                    break;
                case 5:
                    targetStep = '5';
                    break;
                case 6:
                    targetStep = '6';
                    break;
                case 7:
                    targetStep = '7';
                    break;
                case 8:
                    targetStep = '8';
                    break;
                case 9:
                    targetStep = '9';
                    break;
                default:
                    targetStep = stepNum.toString();
            }
            
            // Show target step
            const targetElement = document.getElementById(`step-${targetStep}`);
            if (targetElement) {
                targetElement.classList.add('active');
                
                // Smooth scroll to the step
                targetElement.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start' 
                });
                
                // Update step tracking
                currentStep = stepNum;
                stepHistory.push(stepNum);
                updateProgress();
                updateNavigation();
            }
        }

        function previousStep() {
            if (stepHistory.length > 1) {
                // Remove current step from history
                stepHistory.pop();
                
                // Get previous step
                const prevStep = stepHistory[stepHistory.length - 1];
                
                // Hide current step
                document.querySelector('.step.active').classList.remove('active');
                
                // Show previous step
                let targetStep;
                switch(prevStep) {
                    case 1:
                        targetStep = '1';
                        break;
                    case 2:
                        targetStep = '2b'; // Default to indeterminate path
                        break;
                    case 3:
                        targetStep = '3b'; // Default to small mass path
                        break;
                    default:
                        targetStep = prevStep.toString();
                }
                
                const targetElement = document.getElementById(`step-${targetStep}`);
                if (targetElement) {
                    targetElement.classList.add('active');
                    targetElement.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                }
                
                currentStep = prevStep;
                updateProgress();
                updateNavigation();
            }
        }

        function resetFlow() {
            // Hide all steps
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Show first step
            document.getElementById('step-1').classList.add('active');
            
            // Reset tracking
            currentStep = 1;
            stepHistory = [1];
            updateProgress();
            updateNavigation();
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgress() {
            const progressPercent = (stepHistory.length / totalSteps) * 100;
            document.getElementById('progress').style.width = progressPercent + '%';
        }

        function updateNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const stepIndicator = document.getElementById('stepIndicator');
            
            prevBtn.disabled = stepHistory.length <= 1;
            stepIndicator.textContent = `Step ${stepHistory.length} of ${totalSteps}`;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            updateNavigation();
        });
    </script>

</body>
</html>