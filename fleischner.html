<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Fleischner Society 2017 Guidelines</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7f9;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            display: flex;
            justify-content: center;
        }
        .tool-container {
            max-width: 900px;
            width: 100%;
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.8em;
        }
        h2 {
            text-align: center;
            color: #555;
            font-size: 1.1em;
            margin-top: 0;
            margin-bottom: 30px;
            font-weight: 400;
        }
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
        }
        fieldset {
            border: 1px solid #dcdfe6;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
        }
        legend {
            font-weight: 600;
            color: #005a9c;
            padding: 0 10px;
        }
        .radio-group label {
            display: block;
            margin: 5px 0;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            border: 1px solid #e9ecef;
            transition: all 0.2s ease-in-out;
        }
        .radio-group label:hover {
            border-color: #007bff;
        }
        .radio-group input[type="radio"] {
            margin-right: 10px;
        }
        .hidden {
            display: none;
        }
        #result-container {
            margin-top: 20px;
            padding: 20px;
            background-color: #eaf3fb;
            border: 1px solid #bce8f1;
            border-left: 5px solid #007bff;
            border-radius: 5px;
        }
        #result-container h3 {
            margin-top: 0;
            color: #005a9c;
        }
        #recommendation {
            font-weight: bold;
            font-size: 1.1em;
        }
        #comments {
            margin-top: 10px;
            font-style: italic;
            color: #555;
        }
        .footer-notes {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            font-size: 0.85em;
            color: #666;
        }
    </style>
</head>
<body>

<div class="tool-container">
    <h1>Fleischner Society 2017 Guidelines</h1>
    <h2>Interactive Tool for Management of Incidental Pulmonary Nodules</h2>

    <div class="form-grid">
        <form id="nodule-form">
            <fieldset>
                <legend>1. Nodule Type</legend>
                <div class="radio-group">
                    <label><input type="radio" name="solidity" value="solid"> Solid Nodule(s)</label>
                    <label><input type="radio" name="solidity" value="subsolid"> Subsolid Nodule(s)</label>
                </div>
            </fieldset>

            <!-- Questions for SOLID nodules -->
            <div id="solid-options" class="hidden">
                <fieldset>
                    <legend>2. Number & Risk</legend>
                    <div class="radio-group">
                        <label><input type="radio" name="solid_type" value="single_low"> Single, Low risk</label>
                        <label><input type="radio" name="solid_type" value="single_high"> Single, High risk</label>
                        <label><input type="radio" name="solid_type" value="multiple_low"> Multiple, Low risk</label>
                        <label><input type="radio" name="solid_type" value="multiple_high"> Multiple, High risk</label>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>3. Size (Largest Nodule)</legend>
                    <div class="radio-group">
                        <label><input type="radio" name="solid_size" value="lt_6">&lt;6 mm</label>
                        <label><input type="radio" name="solid_size" value="6_8">6-8 mm</label>
                        <label><input type="radio" name="solid_size" value="gt_8">&gt;8 mm</label>
                    </div>
                </fieldset>
            </div>

            <!-- Questions for SUBSOLID nodules -->
            <div id="subsolid-options" class="hidden">
                 <fieldset>
                    <legend>2. Number</legend>
                    <div class="radio-group">
                        <label><input type="radio" name="subsolid_count" value="single"> Single</label>
                        <label><input type="radio" name="subsolid_count" value="multiple"> Multiple</label>
                    </div>
                </fieldset>
                <fieldset id="subsolid-single-type-options" class="hidden">
                    <legend>3. Nodule Appearance</legend>
                    <div class="radio-group">
                        <label><input type="radio" name="subsolid_single_type" value="gg"> Ground glass</label>
                        <label><input type="radio" name="subsolid_single_type" value="part_solid"> Part solid</label>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>4. Size (Largest Nodule)</legend>
                    <div class="radio-group">
                        <label><input type="radio" name="subsolid_size" value="lt_6">&lt;6 mm</label>
                        <label><input type="radio" name="subsolid_size" value="gte_6">≥6 mm</label>
                    </div>
                </fieldset>
            </div>
        </form>

        <div id="result-container">
            <h3>Recommended Management</h3>
            <p id="recommendation">Please make your selections to see the guideline.</p>
            <p id="comments"></p>
        </div>
    </div>
    
    <div class="footer-notes">
        <p><strong>Note:</strong> These recommendations do not apply to lung cancer screening, patients with immunosuppression, or patients with known primary cancer.</p>
        <p><sup>*</sup> Dimensions are average of long and short axes, rounded to the nearest millimeter. <sup>†</sup> Consider all relevant risk factors (see Risk Factors).</p>
    </div>
</div>

<script>
    // Database of all guidelines from the image
    const guidelines = {
        solid: {
            single_low: {
                lt_6: { rec: "No routine follow-up.", com: "Nodules <6 mm do not require routine follow-up in low-risk patients (recommendation 1A)." },
                '6_8': { rec: "CT at 6-12 months, then consider CT at 18-24 months.", com: "" },
                gt_8: { rec: "Consider CT at 3 months, PET/CT, or tissue sampling.", com: "" }
            },
            single_high: {
                lt_6: { rec: "Optional CT at 12 months.", com: "Certain patients at high risk with suspicious nodule morphology, upper lobe location, or both may warrant 12-month follow-up (recommendation 1A)." },
                '6_8': { rec: "CT at 6-12 months, then consider CT at 18-24 months.", com: "" },
                gt_8: { rec: "Consider CT at 3 months, PET/CT, or tissue sampling.", com: "" }
            },
            multiple_low: {
                lt_6: { rec: "No routine follow-up.", com: "Use most suspicious nodule as guide to management. Follow-up intervals may vary according to size and risk (recommendation 2A)." },
                '6_8': { rec: "CT at 3-6 months, then consider CT at 18-24 months.", com: "Use most suspicious nodule as guide to management. Follow-up intervals may vary according to size and risk (recommendation 2A)." },
                gt_8: { rec: "CT at 3-6 months, then consider CT at 18-24 months.", com: "Use most suspicious nodule as guide to management. Follow-up intervals may vary according to size and risk (recommendation 2A)." }
            },
            multiple_high: {
                lt_6: { rec: "Optional CT at 12 months.", com: "Use most suspicious nodule as guide to management. Follow-up intervals may vary according to size and risk (recommendation 2A)." },
                '6_8': { rec: "CT at 3-6 months, then consider CT at 18-24 months.", com: "Use most suspicious nodule as guide to management. Follow-up intervals may vary according to size and risk (recommendation 2A)." },
                gt_8: { rec: "CT at 3-6 months, then consider CT at 18-24 months.", com: "Use most suspicious nodule as guide to management. Follow-up intervals may vary according to size and risk (recommendation 2A)." }
            }
        },
        subsolid: {
            single_gg: {
                lt_6: { rec: "No routine follow-up.", com: "In certain suspicious nodules < 6 mm, consider follow-up at 2 and 4 years. If solid component(s) or growth develops, consider resection. (Recommendations 3A and 4A)." },
                gte_6: { rec: "CT at 6-12 months to confirm persistence, then CT every 2 years until 5 years.", com: "" }
            },
            single_part_solid: {
                lt_6: { rec: "No routine follow-up.", com: "In practice, part-solid nodules cannot be defined as such until >=6 mm, and nodules <6 mm do not usually require follow-up. Persistent part-solid nodules with solid components >=6 mm should be considered highly suspicious (recommendations 4A-4C)." },
                gte_6: { rec: "CT at 3-6 months to confirm persistence. If unchanged and solid component remains <6 mm, annual CT should be performed for 5 years.", com: "" }
            },
            multiple: {
                lt_6: { rec: "CT at 3-6 months. If stable, consider CT at 2 and 4 years.", com: "Multiple <6 mm pure ground-glass nodules are usually benign, but consider follow-up in selected patients at high risk at 2 and 4 years (recommendation 5A)." },
                gte_6: { rec: "CT at 3-6 months. Subsequent management based on the most suspicious nodule(s).", com: "" }
            }
        }
    };

    // DOM Elements
    const form = document.getElementById('nodule-form');
    const solidityInputs = form.elements['solidity'];
    const solidOptions = document.getElementById('solid-options');
    const subsolidOptions = document.getElementById('subsolid-options');
    const subsolidCountInputs = form.elements['subsolid_count'];
    const subsolidSingleTypeOptions = document.getElementById('subsolid-single-type-options');
    const recommendationEl = document.getElementById('recommendation');
    const commentsEl = document.getElementById('comments');

    // Event Listener for all form changes
    form.addEventListener('change', function(event) {
        // Show/hide main sections based on solidity
        const selectedSolidity = form.elements['solidity'].value;
        if (selectedSolidity === 'solid') {
            solidOptions.classList.remove('hidden');
            subsolidOptions.classList.add('hidden');
        } else if (selectedSolidity === 'subsolid') {
            solidOptions.classList.add('hidden');
            subsolidOptions.classList.remove('hidden');
        }

        // Show/hide subsolid single type options
        const selectedSubsolidCount = form.elements['subsolid_count'].value;
         if (selectedSolidity === 'subsolid' && selectedSubsolidCount === 'single') {
            subsolidSingleTypeOptions.classList.remove('hidden');
        } else if (selectedSolidity === 'subsolid') {
            subsolidSingleTypeOptions.classList.add('hidden');
        }

        updateRecommendation();
    });

    function updateRecommendation() {
        const solidity = form.elements['solidity'].value;
        let result = null;

        if (solidity === 'solid') {
            const type = form.elements['solid_type'].value;
            const size = form.elements['solid_size'].value;
            if (type && size) {
                result = guidelines.solid[type][size];
            }
        } else if (solidity === 'subsolid') {
            const count = form.elements['subsolid_count'].value;
            const size = form.elements['subsolid_size'].value;
            if (count === 'single') {
                const singleType = form.elements['subsolid_single_type'].value;
                if (singleType && size) {
                    result = guidelines.subsolid[singleType === 'gg' ? 'single_gg' : 'single_part_solid'][size];
                }
            } else if (count === 'multiple') {
                 if (size) {
                    result = guidelines.subsolid.multiple[size];
                }
            }
        }

        if (result) {
            recommendationEl.textContent = result.rec;
            commentsEl.textContent = result.com || ""; // Use empty string if no comment
        } else {
            recommendationEl.textContent = "Please complete all selections to see the guideline.";
            commentsEl.textContent = "";
        }
    }
</script>

</body>
</html>